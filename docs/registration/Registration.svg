<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="850px" preserveAspectRatio="none" style="width:564px;height:850px;" version="1.1" viewBox="0 0 564 850" width="564px" zoomAndPan="magnify"><defs><filter height="300%" id="f1q1xwrwkqv5cg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="258.5" cy="18" fill="#000000" filter="url(#f1q1xwrwkqv5cg)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50.2656" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="309" x="104" y="89"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="104" x2="413" y1="115.2969" y2="115.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="199.5" y="106.9951">Basic Info screen</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="289" x="109" y="131.4355">Creates temporary user in separate collection</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="168.5" y="216"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="168.5" x2="348.5" y1="242.2969" y2="242.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="178.5" y="233.9951">Confirm phone number</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="6" y="597"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="6" x2="201" y1="623.2969" y2="623.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="16" y="614.9951">Removed temporary user</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="121.5" y="343"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="121.5" x2="259.5" y1="369.2969" y2="369.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="131.5" y="360.9951">Phone confirmed</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="113" x="284" y="470"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="284" x2="397" y1="496.2969" y2="496.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="294" y="487.9951">Confirm email</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="169" x="295" y="343"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="295" x2="464" y1="369.2969" y2="369.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="305" y="360.9951">SkipPhoneVerification</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="276" y="597"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="276" x2="405" y1="623.2969" y2="623.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="286" y="614.9951">Email confirmed</text><rect fill="#FEFECE" filter="url(#f1q1xwrwkqv5cg)" height="50" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="368" x="156.5" y="708"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="156.5" x2="524.5" y1="734.2969" y2="734.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="348" x="166.5" y="725.9951">Create real user from temporary registration object</text><ellipse cx="123.5" cy="829" fill="none" filter="url(#f1q1xwrwkqv5cg)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="124" cy="829.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><!--link *start to BasicInfo--><path d="M258.5,28.2737 C258.5,41.3608 258.5,64.5555 258.5,83.5207 " fill="none" id="*start-BasicInfo" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="258.5,88.7458,262.5,79.7458,258.5,83.7458,254.5,79.7458,258.5,88.7458" style="stroke: #A80036; stroke-width: 1.0;"/><!--link BasicInfo to ConfirmPhone--><path d="M258.5,139.0911 C258.5,159.7035 258.5,188.9647 258.5,210.8484 " fill="none" id="BasicInfo-ConfirmPhone" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="258.5,215.961,262.5,206.961,258.5,210.961,254.5,206.961,258.5,215.961" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="259.5" y="182.0669">Send confirmation sms</text><!--link ConfirmPhone to ConfirmPhone--><path d="M348.6722,229.6732 C368.8055,230.7156 383.5,234.4912 383.5,241 C383.5,246.9494 371.2226,250.6153 353.7365,251.9975 " fill="none" id="ConfirmPhone-ConfirmPhone" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="348.6722,252.3268,357.9129,255.7341,353.6617,252.0022,357.3936,247.751,348.6722,252.3268" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="389.5" y="245.5669">Resend validation</text><!--link ConfirmPhone to Timeout--><path d="M168.4742,264.9022 C141.1225,273.9978 116.0202,284.8662 107.5,296 C39.9153,384.3157 73.7151,529.0948 93.0868,591.6464 " fill="none" id="ConfirmPhone-Timeout" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="94.6838,596.7238,95.7993,586.9383,93.1837,591.9541,88.1679,589.3385,94.6838,596.7238" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="69.5" y="436.0669">Timeout</text><!--link ConfirmPhone to PhoneConfirmed--><path d="M168.2889,258.8964 C149.1229,267.0194 131.1717,278.8295 119.5,296 C108.7643,311.7936 119.9723,327.1654 136.4136,339.6222 " fill="none" id="ConfirmPhone-PhoneConfirmed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="140.6961,342.7249,135.7546,334.2054,136.6471,339.7914,131.0611,340.6838,140.6961,342.7249" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="120.5" y="309.0669">Follow sms link</text><!--link ConfirmPhone to PhoneConfirmed--><path d="M245.0654,266.0911 C233.9357,286.8774 218.0967,316.4592 206.3484,338.4008 " fill="none" id="ConfirmPhone-PhoneConfirmed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="203.9067,342.961,211.6814,336.915,206.2669,338.5531,204.6288,333.1386,203.9067,342.961" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="230.5" y="309.0669">Code in sms</text><!--link ConfirmPhone to ConfirmEmail--><path d="M348.6737,252.6628 C401.6824,261.512 461.5494,275.6611 478.5,296 C506.1137,329.1335 501.1209,354.5895 481.5,393 C464.6013,426.0814 431.4099,450.9145 401.4743,467.7914 " fill="none" id="ConfirmPhone-ConfirmEmail" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="397.0835,470.2238,406.8945,469.3614,401.4572,467.8008,403.0177,462.3635,397.0835,470.2238" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ConfirmPhone to SkipPhoneVerification--><path d="M287.275,266.0329 C297.4071,275.1943 308.705,285.8147 318.5,296 C331.4672,309.484 345.0028,325.2639 356.0199,338.6088 " fill="none" id="ConfirmPhone-SkipPhoneVerification" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="359.3547,342.6669,356.7309,333.174,356.1802,338.804,350.5502,338.2532,359.3547,342.6669" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="334.5" y="309.0669">Skip SMS Verification</text><!--link SkipPhoneVerification to ConfirmEmail--><path d="M371.7949,393.0911 C365.4384,413.7905 356.4035,443.2118 349.6742,465.125 " fill="none" id="SkipPhoneVerification-ConfirmEmail" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="348.1891,469.961,354.655,462.5318,349.6569,465.1813,347.0075,460.1833,348.1891,469.961" style="stroke: #A80036; stroke-width: 1.0;"/><!--link PhoneConfirmed to ConfirmEmail--><path d="M185.4903,393.277 C183.978,408.2336 184.798,426.7773 194.5,440 C205.1143,454.4661 243.8447,468.6896 278.7474,479.0472 " fill="none" id="PhoneConfirmed-ConfirmEmail" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="283.8654,480.5469,276.3536,474.1773,279.0672,479.1407,274.1037,481.8544,283.8654,480.5469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="195.5" y="436.0669">Email confirmation send</text><!--link ConfirmEmail to ConfirmEmail--><path d="M397.24,483.3757 C416.5108,483.3147 432,487.1895 432,495 C432,502.0783 419.2789,505.9242 402.5506,506.5377 " fill="none" id="ConfirmEmail-ConfirmEmail" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="397.24,506.6243,406.3041,510.4769,402.2393,506.5427,406.1735,502.478,397.24,506.6243" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="438" y="499.5669">Resend Validation</text><!--link ConfirmEmail to Timeout--><path d="M293.6764,520.0911 C253.5878,541.5732 195.9685,572.4494 154.6737,594.5778 " fill="none" id="ConfirmEmail-Timeout" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="150.2263,596.961,160.0484,596.2359,154.6334,594.5994,156.2699,589.1844,150.2263,596.961" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="237.5" y="563.0669">Timeout</text><!--link ConfirmEmail to EmailConfirmed--><path d="M340.5,520.0911 C340.5,540.7035 340.5,569.9647 340.5,591.8484 " fill="none" id="ConfirmEmail-EmailConfirmed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="340.5,596.961,344.5,587.961,340.5,591.961,336.5,587.961,340.5,596.961" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="341.5" y="563.0669">Email link</text><!--link EmailConfirmed to CreateUser--><path d="M340.5,647.1876 C340.5,663.6504 340.5,685.2461 340.5,702.6543 " fill="none" id="EmailConfirmed-CreateUser" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="340.5,707.9121,344.5,698.9121,340.5,702.9121,336.5,698.9121,340.5,707.9121" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CreateUser to *end--><path d="M283.7692,758.0975 C234.3863,779.9443 166.3151,810.0587 137.3956,822.8526 " fill="none" id="CreateUser-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="132.7808,824.8942,142.6296,824.9109,137.3533,822.8712,139.3929,817.5949,132.7808,824.8942" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Timeout to *end--><path d="M105.9524,647.3823 C110.1505,690.8324 118.5914,778.1959 122.0108,813.5864 " fill="none" id="Timeout-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="122.515,818.8054,125.6309,809.4624,122.0341,813.8286,117.668,810.2318,122.515,818.8054" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml current_registration_flow

[*] - -> BasicInfo
state "Basic Info screen" as BasicInfo: Creates temporary user in separate collection

BasicInfo - -> ConfirmPhone: Send confirmation sms
state "Confirm phone number" as ConfirmPhone

ConfirmPhone -> ConfirmPhone: Resend validation
ConfirmPhone - -> Timeout: Timeout
ConfirmPhone - -> PhoneConfirmed: Follow sms link
ConfirmPhone - -> PhoneConfirmed: Code in sms
ConfirmPhone - -> ConfirmEmail
ConfirmPhone - -> SkipPhoneVerification: Skip SMS Verification
SkipPhoneVerification - -> ConfirmEmail
state "Phone confirmed" as PhoneConfirmed
PhoneConfirmed - -> ConfirmEmail: Email confirmation send

state "Confirm email" as ConfirmEmail
ConfirmEmail -> ConfirmEmail: Resend Validation
ConfirmEmail - -> Timeout: Timeout
ConfirmEmail - -> EmailConfirmed: Email link

state "Email confirmed" as EmailConfirmed
EmailConfirmed - -> CreateUser

state "Create real user from temporary registration object" as CreateUser
CreateUser - -> [*]

state "Removed temporary user" as Timeout
Timeout - -> [*]
@enduml

PlantUML version 1.2019.03(Sun Mar 10 13:04:44 EET 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.2+9-LTS
Operating System: Linux
OS Version: 4.15.0-46-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>