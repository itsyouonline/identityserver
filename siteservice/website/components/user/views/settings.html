<div flex-gt-sm="80" flex="100" layout="column" ng-init="vm.loadSettings()">
    <div class="breadcrumb-container">
        <p ng-bind="::vm.userIdentifier">You</p>
        <h1 translate='user.views.settings.settings'>Settings</h1>
    </div>
    <md-card>
        <md-card-content>
            <div class="loading-container" layout-align="center center" ng-if="!vm.loaded.APIKeys">
                <md-progress-circular md-mode="indeterminate" md-diameter="50"></md-progress-circular>
            </div>
            <div ng-if="vm.loaded.APIKeys" flex="100" flex-gt-xs="70" flex-gt-sm="50" flex-gt-md="40"
                 class="tab-settings">
                <md-toolbar>
                    <div class="md-toolbar-tools" layout-align="space-between center">
                        <span><i class="fa fa-key"></i> <span translate='user.views.settings.apikeys'>API keys</span></span>
                        <md-button ng-click="vm.showAPIKeyDialog($event)">
                            <i class="fa fa-plus"></i> <span translate='add'>Add</span>
                        </md-button>
                    </div>
                </md-toolbar>
                <md-list>
                    <md-list-item ng-repeat="APIKey in vm.APIKeys"
                                  ng-click="vm.showAPIKeyDialog($event, APIKey)"
                                  aria-label="API key" translate-attr="{ 'aria-label': 'user.views.settings.apikey' }">
                        <div class="md-list-item-text">
                            <h4>{{APIKey.label}}</h4>
                        </div>
                    </md-list-item>
                </md-list>
                <md-toolbar>
                  <div class="md-toolbar-tools" layout-align="space-between center">
                    <span><i class="fa fa-lock"></i> <span translate='user.views.settings.security'>Security</span></span>
                  </div>
                </md-toolbar>
                <md-list>
                    <md-list-item>
                        <div class="md-list-item-text">
                            <p translate='user.views.settings.password'>Password</p>
                        </div>
                        <md-button class="md-primary md-secondary"
                                   ng-click="vm.showChangePasswordDialog($event)" translate='user.views.settings.change'>
                            Change
                        </md-button>
                    </md-list-item>
                </md-list>
                <md-toolbar>
                        <div class="md-toolbar-tools" layout-align="space-between center">
                            <span><i class="fa fa-lock"></i> <span translate='user.views.settings.twofa'>Two FA Authentication</span></span>
                        </div>
                </md-toolbar>
                <md-list>
                        <md-list-item>
                                <span translate="user.views.settings.enable2fa">Enable Two Factor Authentication</span> 
                                <md-checkbox ng-model="vm.user.twofa.enable" md-no-ink ng-change="vm.updateUserTwoFASettings()" aria-label="Enable Two Factor authentication?">
                                       
                                        </md-checkbox>            
                                </md-checkbox>
                        </md-list-item>
                        <md-list-item>
                                <span translate="user.views.settings.skip2fafororgs">Skip 2-FA for organizations when not required</span> 
                                <md-checkbox ng-model="vm.user.twofa.skipfororgsifoptional" md-no-ink ng-change="vm.updateUserTwoFASettings()" aria-label="Enable Two Factor authentication?">
                                         </md-checkbox>            
                                 </md-checkbox>
                        </md-list-item>
                </md-list>
                <hr>
                <md-list>
                   
                    <md-list-item>
                        <div class="md-toolbar-tools" layout-align="space-between center" >
                            <span><i class="fa fa-lock"></i> <span translate='user.views.settings.authenticatorapp'>Authenticator application</span></span>
                        </div>
                        <md-button class="md-primary md-secondary"
                                   ng-click="vm.showSetupAuthenticatorApplication($event)"
                                   ng-if="!vm.twoFAMethods.totp" translate='user.views.settings.setup'>
                            Setup
                        </md-button>
                        <md-button class="md-warn md-secondary"
                                   ng-click="vm.removeAuthenticatorApplication($event)"
                                   ng-if="vm.twoFAMethods.totp" translate='user.views.settings.remove'>
                            Remove
                        </md-button>
                    </md-list-item>
                    <md-list-item ng-if="vm.twoFAMethods.totp">
                        <div class="md-list-item-text">
                            <p translate='qrcode'>QR code</p>
                        </div>
                        <md-button class="md-primary md-secondary"
                                   ng-click="vm.showExistingAuthenticatorApplication($event)"
                                   translate='qrcode_view'>
                            View existing QR code
                        </md-button>
                    </md-list-item>
                </md-list>
                <hr>
                <md-list>
                    <md-list-item>
                            <div class="md-toolbar-tools" layout-align="space-between center">
                                    <span><i class="fa fa-phone"></i> <span translate='user.views.profile.phonenumbers'>Phone numbers</span></span>
                                    <md-button ng-click="vm.showPhonenumberDetailDialog($event)">
                                        <i class="fa fa-plus"></i> <span translate='add'>Add</span>
                                    </md-button>
                                </div>
                    </md-list-item>
                                <md-list>
                                        <div ng-repeat="phone in vm.user.phonenumbers track by phone.label"
                                             layout="row" layout-align="space-between center">
                                            <md-list-item class="md-2-line" flex="80"
                                                          ng-click="vm.showPhonenumberDetailDialog($event, phone)"
                                                          aria-label="Phone {{ phone.label }} - {{ phone.phonenumber }}">
                                                <div class="md-list-item-text">
                                                    <h4 ng-bind="phone.phonenumber"></h4>
                                                    <p ng-bind="phone.label"></p>
                                                </div>
                                            </md-list-item>
                                            <p ng-if="phone.verified" class="md-body-1 verified">
                                                <i class="fa fa-check green"></i> <span translate='user.views.profile.verified'>Verified</span>
                                            </p>
                                            <md-button ng-click="vm.verifyPhone($event, phone)"
                                                       class="md-primary md-secondary"
                                                       ng-if="vm.loaded.verifiedPhones && !phone.verified">
                                                <span translate="verify">Verify</span>
                                            </md-button>
                                        </div>
                </md-list>
            </div>
        </md-card-content>
    </md-card>
</div>
